Примеры SQL-запросов к удаленной БД

Задания взяты с сайта sql-academy.org

Пример 1.

<b>Задание:</b> 
Сколько и кто из семьи потратил на развлечения (entertainment). Вывести статус в семье, имя, сумму

Решение:
SELECT status, member_name, SUM(unit_price*amount) AS costs
FROM  FamilyMembers
INNER JOIN Payments JOIN Goods JOIN GoodTypes
ON FamilyMembers.member_id = Payments.family_member AND Payments.good = Goods.good_id AND Goods.type = GoodTypes.good_type_id
WHERE good_type_name = 'entertainment'
GROUP BY member_name, status


Пример 2.

Задание: 
Найдите максимальный возраст (колич. лет) среди обучающихся 10 классов 

Решение:
SELECT MAX(((YEAR(CURRENT_DATE) - YEAR(birthday)) - (DATE_FORMAT(CURRENT_DATE, '%m%d') < DATE_FORMAT(birthday, '%m%d')))) as max_year 
FROM Student
INNER JOIN Student_in_class JOIN Class ON Student.id = Student_in_class.student AND Student_in_class.class = Class.id
WHERE name LIKE '%10%'
Пример 3.

Задание: 
Какой(ие) кабинет(ы) пользуются самым большим спросом?

Решение:
SELECT classroom FROM (
SELECT classroom, COUNT(*) AS cnt FROM Schedule
GROUP BY classroom) AS cnt
WHERE cnt = (SELECT MAX(cnt) FROM (
SELECT classroom, COUNT(*) AS cnt FROM Schedule
GROUP BY classroom) AS cnt)
